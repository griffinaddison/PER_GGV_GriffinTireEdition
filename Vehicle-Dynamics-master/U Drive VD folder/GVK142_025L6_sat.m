function out = GVK142_025L6_sat(T,w)
    % semi complete model
    % missing voltage effects, only accounted for in Pmax (from 250V)
    T = T*.0254*4.448;%Nm
    kt = .155; %Nm/Arms
    r = .100947; %ohm
    Tf = .02435;%Friction torque
    B = 1.0838e-4;%viscous torque constant
    T_sat_poly = [-.000512 .223 -2.313];%ax2 + bx + c
    ki_fw = 1790000/60*(2*pi); %I = ki/w % field weakening current limit
    kt_fw = [-.0102;32.3];
    w_lim = 1600;%rad/s limit
%     ws = [0,17.2614981000000,34.5229961900000,51.7844942900000,69.0459923900000,86.3074904800000,103.568988600000,120.830486700000,138.091984800000,155.353482900000,172.614981000000,189.876479100000,207.137977200000,224.399475300000,241.660973400000,258.922471400000,276.183969500000,293.445467600000,310.706965700000,327.968463800000,345.229961900000,362.491460000000,379.752958100000,397.014456200000,414.275954300000,431.537452400000,448.798950500000,466.060448600000,483.321946700000,500.583444800000,517.844942900000,535.106441000000,552.367939100000,569.629437200000,586.890935300000,604.152433400000,621.413931500000,638.675429600000,655.936927700000,673.198425800000,690.459923900000,707.721422000000,724.982920100000,742.244418200000,759.505916300000,776.767414300000,794.028912400000,811.290410500000,828.551908600000,845.813406700000,863.074904800000,880.336402900000,897.597901000000,914.859399100000,932.120897200000,949.382395300000,966.643893400000,983.905391500000,1001.16689000000,1018.42838800000,1035.68988600000,1052.95138400000,1070.21288200000,1087.47438000000,1104.73587800000,1121.99737600000,1139.25887400000,1156.52037200000,1173.78187100000,1191.04336900000,1208.30486700000,1225.56636500000,1242.82786300000,1260.08936100000,1277.35085900000,1294.61235700000,1311.87385500000,1329.13535300000,1346.39685200000,1363.65835000000,1380.91984800000,1398.18134600000,1415.44284400000,1432.70434200000,1449.96584000000,1467.22733800000,1484.48883600000,1501.75033400000,1519.01183300000,1536.27333100000,1553.53482900000,1570.79632700000];%rad/s
%     ps = [0,326.299797900000,652.523780100000,978.669841100000,1304.73587400000,1630.71977100000,1956.61942400000,2282.43272000000,2608.15754700000,2933.79179100000,3259.33333600000,3584.78006100000,3910.12984700000,4235.38056900000,4560.53010200000,4885.57631500000,5210.51707800000,5535.35025300000,5860.07370400000,6184.68528700000,6509.18285800000,6833.56426600000,7157.82735900000,7481.96997800000,7805.98996200000,8129.88514500000,8453.65335600000,8777.29241900000,9100.80015500000,9424.17437800000,9747.41289600000,10070.5135100000,10393.4740300000,10716.2922400000,11038.9659300000,11361.4928700000,11683.8708500000,12006.0976300000,12328.1709700000,12650.0886400000,12971.8483600000,13293.4479000000,13614.8849800000,13936.1573200000,14257.2626500000,14578.1986800000,14898.9631100000,15219.5536400000,15539.9679500000,15860.2037300000,16180.2586300000,16500.1303300000,16819.8164800000,17139.3147200000,17458.6226800000,17777.7379800000,18096.6582500000,18415.3810900000,18733.9041000000,19052.2248500000,19370.3409200000,19688.2498800000,20005.9492900000,20323.4366700000,20640.7095700000,20942.1971700000,21211.4040900000,21455.5793200000,21681.8093100000,21883.3641200000,22059.4144500000,22227.9417600000,22374.6072700000,22522.2943500000,22651.7632200000,22762.5694600000,22854.2831700000,22958.9976900000,23048.3363700000,22999.7904000000,23149.8113400000,23155.8712900000,23155.0596800000,23147.7635500000,23279.0140600000,23260.9016600000,23237.1595000000,23208.0859000000,23322.7399300000,23284.4627600000,23241.5234800000,23194.1548900000];
    
%     Pmax = interpolate(ws,ps,w);
%     if Pout>Pmax %exceeded linear power region
%         Pout = Pmax;
%         T = Pmax/w;
%     end
    if w > w_lim %speed limit
        T = 0;
    end
    if T<=11 %Torque saturation begins
        I = T/kt;
    elseif T<=20 %peak torque 
        a = roots([T_sat_poly(1:2) T_sat_poly(3)-T]);
        I = a(end);
    else
        T = 20;
        I = 156;
    end
    if I>(ki_fw/w) %field weakening range
        I = ki_fw/w;
        T = kt_fw(1)*w + kt_fw(2);
    end
    Pout = T*w;%W
    Ploss = w*(Tf+B*w)+I^2*r; %moving and resistive losses
    Pdraw = Pout+Ploss;
    Sat = 1-(T/(kt*I));
    out = [Pout/4.448/.0254, I, Pdraw/4.448/.0254, T/4.448/.0254, Ploss/4.448/.0254, Sat];
end
    
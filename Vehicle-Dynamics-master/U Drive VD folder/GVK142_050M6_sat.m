function out = GVK142_050M6_sat(T,w)
    % semi complete model
    % missing voltage effects, only accounted for in fw (from 250V)
    T = T*.0254*4.448;%Nm
    kt = .242; %Nm/Arms
    r = .087; %ohm
    Tf = .0487;%Friction torque
    B = 2.168e-4;%viscous torque constant
    T_sat_poly = [-.000549 .3287 -3.394];%ax2 + bx + c
    ki_fw = 1520000/60*(2*pi); %I = ki/w % field weakening current limit
    kt_fw = [-.0284;63.6];
    w_lim = 1600;%rad/s limit
%     ws = [0,17.2614981000000,34.5229961900000,51.7844942900000,69.0459923900000,86.3074904800000,103.568988600000,120.830486700000,138.091984800000,155.353482900000,172.614981000000,189.876479100000,207.137977200000,224.399475300000,241.660973400000,258.922471400000,276.183969500000,293.445467600000,310.706965700000,327.968463800000,345.229961900000,362.491460000000,379.752958100000,397.014456200000,414.275954300000,431.537452400000,448.798950500000,466.060448600000,483.321946700000,500.583444800000,517.844942900000,535.106441000000,552.367939100000,569.629437200000,586.890935300000,604.152433400000,621.413931500000,638.675429600000,655.936927700000,673.198425800000,690.459923900000,707.721422000000,724.982920100000,742.244418200000,759.505916300000,776.767414300000,794.028912400000,811.290410500000,828.551908600000,845.813406700000,863.074904800000,880.336402900000,897.597901000000,914.859399100000,932.120897200000,949.382395300000,966.643893400000,983.905391500000,1001.16689000000,1018.42838800000,1035.68988600000,1052.95138400000,1070.21288200000,1087.47438000000,1104.73587800000,1121.99737600000,1139.25887400000,1156.52037200000,1173.78187100000,1191.04336900000,1208.30486700000,1225.56636500000,1242.82786300000,1260.08936100000,1277.35085900000,1294.61235700000,1311.87385500000,1329.13535300000,1346.39685200000,1363.65835000000,1380.91984800000,1398.18134600000,1415.44284400000,1432.70434200000,1449.96584000000,1467.22733800000,1484.48883600000,1501.75033400000,1519.01183300000,1536.27333100000,1553.53482900000,1570.79632700000];%rad/s
%     ps = [0,677.370402200000,1354.58334100000,2031.63350800000,2708.51558700000,3385.22425700000,4061.75419200000,4738.10005500000,5414.25650500000,6090.21818800000,6765.97974400000,7441.53580100000,8116.88097600000,8792.00987400000,9466.91708900000,10141.5972000000,10816.0447700000,11490.2543500000,12164.2204800000,12837.9376800000,13511.4004500000,14184.6032700000,14857.5406100000,15530.2069100000,16202.5966100000,16874.7041000000,17546.5237800000,18218.0500100000,18889.2771200000,19560.1994200000,20230.8112200000,20900.9789000000,21495.1012100000,21965.6983400000,22338.1432700000,22615.2585100000,22864.4509800000,23060.0519700000,23125.8832600000,23357.0808600000,23434.2396900000,23615.5562900000,23638.8260500000,23777.2663700000,23755.0186200000,23711.7115300000,23649.2248100000,23716.1690100000,23620.8315600000,23510.4522700000,23386.2109700000,23398.4471600000,23249.4636700000,23089.2945900000,23068.2227000000,22887.5033000000,22697.5873500000,22499.0478000000,22292.4009600000,22078.1128200000,21856.6044600000,21628.2568000000,21393.4146500000,21152.3903500000,20905.4668600000,20654.1404800000,20399.7419100000,20003.7558800000,19744.2435400000,19481.3739900000,19080.9481300000,18812.1932400000,18408.3958400000,18133.2293300000,17725.2214200000,17443.1432400000,17030.1344200000,16614.9499300000,16197.3228400000,15776.9942200000,15353.7121300000,14927.2307000000,14497.3092900000,14063.7116800000,13507.1425800000,12947.9679200000,12385.6993900000,11819.8605300000,11249.9846800000,10560.5989000000,9867.40764300000,9169.62615000000,0,0,0,0];%lbin/sec
    
%     Pmax = interpolate(ws,ps,w);
%     if Pout>Pmax %exceeded linear power region
%         Pout = Pmax;
%         T = Pmax/w;
%     end
    if w > w_lim %speed limit
        T = 0;
    end
    if T<=22 %Torque saturation begins
        I = T/kt;
    elseif T<=34.5 %peak torque 
        a = roots([T_sat_poly(1:2) T_sat_poly(3)-T]);
        I = a(end);
    else
        T = 34.5;
        I = 156;
    end
    if I>(ki_fw/w) %field weakening range
        I = ki_fw/w;
        T = kt_fw(1)*w + kt_fw(2);
    end
    Pout = T*w;%W
    
    Ploss = w*(Tf+B*w)+I^2*r; %moving and resistive losses
    Pdraw = Pout+Ploss;
    Sat = 1-(T/(kt*I));
    out = [Pout/4.448/.0254, I, Pdraw/4.448/.0254, T/4.448/.0254, Ploss/4.448/.0254, Sat];
end